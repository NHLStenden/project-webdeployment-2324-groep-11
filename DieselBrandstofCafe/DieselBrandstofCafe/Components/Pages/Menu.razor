@page "/menu"
@using DieselBrandstofCafe.Components.Models
@using DieselBrandstofCafe.Components.Data
@inject ICustomerService customerService

<div class="menu-page">
    <div class="left-panel">
        <div class="categories">
            <h2>Categories</h2>
            <div class="category-list">
                <div class="category-card"><button class="category-button"><img src=""><span>Beverages</span></button></div>
                <div class="category-card"><button class="category-button"><img src=""><span>Breakfast</span></button></div>
                <div class="category-card"><button class="category-button"><img src=""><span>Sandwiches</span></button></div>
                <div class="category-card"><button class="category-button"><img src=""><span>Soup & Salad</span></button></div>
                <div class="category-card"><button class="category-button"><img src=""><span>Pastry & Desserts</span></button></div>
            </div>
        </div>
        <div class="menu-items">
            <h2>Select Menu</h2>
            <div class="menu-list">
                @if (menuItems == null)
                {
                    <p>Loading...</p>
                }
                else if (!menuItems.Any())
                {
                    <p>No items found.</p>
                }
                else
                {
                    @foreach (var item in menuItems)
                    {
                        <div class="menu-item">
                            <h3>@item.ProductNaam</h3>
                            @* <p>@item.Beschrijving</p> *@
                            <p>€@item.Prijs</p>
                            <button @onclick='() => AddToInvoice(item)'>Add to order</button>
                        </div>
                    }
                }
                @* <div class="menu-item">
                    <h3>Espresso</h3>
                    <p>Strong Italian coffee, base for drinks like lattes.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Espresso", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Americano</h3>
                    <p>Espresso diluted with hot water, mimicking regular black coffee.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Americano", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Cappuccino</h3>
                    <p>Equal parts espresso, steamed milk, and frothy milk foam.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Cappuccino", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Flat White</h3>
                    <p>Espresso with velvety microfoam milk, stronger than a latte.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Flat White", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Macchiato</h3>
                    <p>Espresso marked with a dollop of frothy milk.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Macchiato", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Cappuccino</h3>
                    <p>Espresso mixed with chocolate and steamed milk, topped with whipped cream.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Cappuccino", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Affogato</h3>
                    <p>Espresso poured over a scoop of vanilla ice cream.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Affogato", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Ristretto</h3>
                    <p>A short shot of espresso, more concentrated and less bitter.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Ristretto", Prijs = 3 })'>Add to order</button>
                </div>
                <div class="menu-item">
                    <h3>Cold Coffee</h3>
                    <p>Chilled coffee served over ice, often sweetened and creamy.</p>
                    <p>€3</p>
                    <button @onclick='() => AddToInvoice(new Product { ProductNaam = "Cold Coffee", Prijs = 3 })'>Add to order</button>
                </div>
                <!-- Voeg meer menu items toe --> *@
            </div>
        </div>
    </div>
    <div class="right-panel">
        <div class="order-summary">
            <h2>Invoice</h2>
            <ul>
                @foreach (var item in invoiceItems)
                {
                    <li>@item.ProductNaam (€@item.Prijs) <button @onclick="() => RemoveFromInvoice(item)">Remove</button></li>
                }
            </ul>
            <div class="payment">
                <h5>Payment</h5>
                <p>Sub Total: €@subTotal</p>
                <p>Tax: €@tax</p>
                <p>Total Payment: €@total</p>
                <div class="payment-methods">
                    <button>Card</button>
                    <button>Cash</button>
                    <button>Ideal</button>
                </div>
                <button class="place-order-button">Place the order</button>
            </div>
        </div>
        <div class="additional-cards">
            <div class="popular-products">
                <h5>Popular Products</h5>
                <ul>
                    <li>Product 1</li>
                    <li>Product 2</li>
                    <li>Product 3</li>
                </ul>
            </div>
            <div class="sign-up-updates">
                <h5>Sign up for updates</h5>
                <form>
                    <input type="email" placeholder="Enter your email" required>
                    <button type="submit">Sign Up</button>
                </form>
            </div>
        </div>
    </div>
</div>

@code {

    List<Product>? menuItems;

    protected override async Task OnInitializedAsync()
    {
        menuItems = (await customerService.GetProductsAsync()).ToList();
    }

    // Lijst om items op de factuur bij te houden
    List<Product> invoiceItems = new List<Product>();

    decimal subTotal = 0;
    decimal tax = 0;
    decimal total = 0;

    // Functie om een item toe te voegen aan de factuur
    void AddToInvoice(Product item)
    {
        invoiceItems.Add(item);
        UpdateTotals();
    }

    // Functie om een item te verwijderen van de factuur
    void RemoveFromInvoice(Product item)
    {
        invoiceItems.Remove(item);
        UpdateTotals();
    }

    // Functie om totaalbedrag van de factuur te berekenen
    void UpdateTotals()
    {
        subTotal = invoiceItems.Sum(item => item.Prijs);
        tax = subTotal * 0.09M; // Eten is volgens mij een btw percentage van 9%
        total = subTotal + tax;
    }
}
